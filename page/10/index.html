<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="这里是外宅，备份用的">
<meta property="og:type" content="website">
<meta property="og:title" content="九王爷">
<meta property="og:url" content="http://yoursite.com/page/10/index.html">
<meta property="og:site_name" content="九王爷">
<meta property="og:description" content="这里是外宅，备份用的">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="九王爷">
<meta name="twitter:description" content="这里是外宅，备份用的">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/10/"/>





  <title> 九王爷 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">九王爷</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">九王爷的府邸</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/03/23/gentoo_下面配置xorg/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/03/23/gentoo_下面配置xorg/" itemprop="url">
                  gentoo 下面配置xorg
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-03-23T09:04:09+08:00">
                2009-03-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Gentoo下面配置xorg是非常容易的，步骤如下：<br>emerge xorg-x11 安装好xorg<br>然后 只需要Xorg -configure 一下就会自动产生xorg的配置文件，不过要注意的是产生的新配置文件是在/root里面<br>下一步测试新配置文件<br>X -config /root/xorg.conf.new<br>正常情况下是不会启动成功的：），因为还没安装卡的驱动<br>emerge nvidia-drivers （这里因为我的是n卡所以用的nvidia-drivers,根据自己的情况看）<br>安装显卡驱动<br>安装完以后再<br>Xorg -configure<br>X -config /root/xorg.conf.new</p>
<p>看看是不是成功了呢？反正我是没成功（好事多磨哦）<br>看失败原因（直接会显示在屏幕上，如果你有 兴趣也可以去/var/log/里看xorg的log）<br>Failed to load module “wfb” (module does not exist, 0)</p>
<p>解决方法如下：<br>执行<br>eselect opengl set nvidia<br>然后再<br>Xorg -configure<br>X -config /root/xorg.conf.new<br>一下，终于成功了，看到了几个简陋的窗口</p>
<p>其实gentoo的文档资源是非常的丰富的，只要遇到问题你去gentoo上面查找一般都能找到howto。当然，google更是好老师，遇到问题就去Google一般都能找到答案</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/03/20/Linux_webserver_常用维护命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/03/20/Linux_webserver_常用维护命令/" itemprop="url">
                  Linux webserver 常用维护命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-03-20T09:03:22+08:00">
                2009-03-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/Server/" itemprop="url" rel="index">
                    <span itemprop="name">Server</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这里是维护时常用的一些命令，放在这里，备忘</p>
<p><span style="color: #ff0000;">注：大部分非原创，只是收集到这里而已</span></p>
<ul>
<li><p>实时查看正在执行的sql语句<br>1./usr/sbin/tcpdump -i eth0 -s 0 -l -w - dst port 3306 | strings | egrep -i ‘SELECT|UPDATE|DELETE|INSERT|SET|COMMIT|ROLLBACK|CREATE|DROP|ALTER|CALL’</p>
</li>
<li><p>查看http连接<br>1.netstat -n | awk ‘/^tcp/ {++state[$NF]} END {for(key in state) print key,”\t”,state[key]}’</p>
</li>
<li><p>查看SYN状态的http连接<br>1.netstat -an | grep SYN | awk ‘{print $5}’ | awk -F: ‘{print $1}’ | sort | uniq -c | sort -nr | more</p>
</li>
<li><p>查看TIME_WAIT状态的http连接<br>1.netstat -tna | cut -b 49- |grep TIME_WAIT | sort |more<br>2.netstat -an | grep TIME_WAIT | awk ‘{print $5}’ | awk -F: ‘{print $1}’ | sort | uniq -c | sort -nr | more</p>
</li>
<li><p>查看ESTABLISHED状态的http连接<br>1.netstat -an | grep ESTABLISHED | awk ‘{print $5}’ | awk -F: ‘{print $1}’ | sort | uniq -c | sort -nr | more<br>2.netstat -an | grep “:80” | grep ESTABLISHED | sort | more</p>
</li>
<li><p>批量kill进程<br>1.ps -efww|grep sqlr-listener|grep -v grep|cut -c 9-15|xargs kill -9</p>
</li>
<li><p>查看活动的php-cgi连接数<br>1.netstat -anpo|grep php-cgi|wc -l</p>
</li>
<li><p>按ip查看httpd连接数<br>1.netstat -anlp | grep 80 | grep tcp | awk {‘print $5’} | awk -F: {‘print $1’}| sort |uniq -c | sort -nr</p>
</li>
<li><p>禁IP<br>1.iptables -A INPUT -s IP地址 -j REJECT<br>2.iptables -A INPUT -s IP地址/24 -j REJECT<br>3.route add -net IP地址 netmask 255.255.255.0 reject</p>
</li>
<li><p>调试命令<br>1.strace -p pid</p>
</li>
<li><p>跟踪指定的进程pid.<br>1.gdb -p pid</p>
</li>
<li><p>跟踪指定的进程pid.</p>
</li>
<li><p>批量查找文件并删除<br>1.find . -name test.php -exec rm {} \;<br>2.find . -name test.php | xargs rm -rf</p>
</li>
<li><p>更改某一目录下所有目录的权限, 不包括文件, aaa 是目录名<br>1.find aaa -type d -exec chmod 755 {} \;</p>
</li>
<li><p>替换文件内容<br>1.sed -i ‘s/b/strong/g’ index.html</p>
</li>
</ul>
<p>此命令搜索 index.html 文件中的 b 并将其替换为 strong。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/03/20/调整SSHD的启动优先级别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/03/20/调整SSHD的启动优先级别/" itemprop="url">
                  调整SSHD的启动优先级别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-03-20T09:00:57+08:00">
                2009-03-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/Server/" itemprop="url" rel="index">
                    <span itemprop="name">Server</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在实际的服务器使用中，我们经常遇到的一个情况就是服务器无响应，有可能是由于apache或者是mysql等服务过载造成服务器无响应。九王爷就遇到过几次这种情况，好几次说服务器没响应，ssh也上不去，只好请机房的人员帮助重启机器。重启机器后发现log等服务还是在运行的，也就是说服务器不是真的死机了，而是反应不过来，如果当时能ssh上去看看的话就能找到原因了。所以希望能在apache等没反应以后还能ssh上服务器<br><span><br>这就需要将ssh的运行优先级给调高一些，而我又是个懒人，希望能每次重启后自动的就把优先级给调整了。查看sshd_conf里面没有相应的选项，就只好在启动脚本里面打主意了。<br>查看启动脚本/etc/init.d/sshd ，修改里面的<br>$SSHD $OPTIONS &amp;&amp; success || failure<br>为<br>nice -n -2 $SSHD $OPTIONS &amp;&amp; success || failure<br>使用-2优先级是希望sshd服务的优先级高于apache等的0，但低于log等的-5</span></p>
<p>sudo /etc/init.d/sshd restart<br>一下，然后<br>ps -aeo cmd,pid,nice |grep sshd<br>看下优先级是不是变成-2了呢？</p>
<p></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/03/19/'[linux服务器][进程管理]用fuser杀掉进程'/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/03/19/'[linux服务器][进程管理]用fuser杀掉进程'/" itemprop="url">
                  [linux服务器][进程管理]用fuser杀掉进程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-03-19T08:59:24+08:00">
                2009-03-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/Server/" itemprop="url" rel="index">
                    <span itemprop="name">Server</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>转的CU上一条大牛的，转载这里备忘（以前是不转过来的，但是最近发现很多文章所在网站都死掉了，因为没保存，很多好文也没有了）原文地址 <a href="http://blog.chinaunix.net/u2/82938/showart_1839189.html" target="_blank" rel="external">http://blog.chinaunix.net/u2/82938/showart_1839189.html</a><br>用fuser杀掉进程</p>
<p>一，为什么要使用fuser?<br>先说 fuser的作用，<br>fuser能识别出正在对某个文件或端口访问的进程<br>大家想一下，还有哪个命令具备这个功能?<br>没错，是lsof,<br>我们前面讲过, lsof能够找出正在对指定文件访问的进程，<br>那么它们两者之间有何区别?<br>fuser有一个特别的用法在于它可以一次杀死那些正在访问指定文件的进程<br><span></span></p>
<p>二，如何使用fuser?</p>
<p>1,如何用fuser得到正在使用指定文件的进程?<br>用法: fuser 文件<br>说明：它会把正在使用当前文件的进程id列出</p>
<p>[root@localhost lhd]# umount /<br>umount: /: device is busy.<br>(In some cases useful info about processes that use<br>the device is found by lsof(8) or fuser(1))<br>[root@localhost lhd]# fuser /<br>/: 1rc 2rc 3rc 4rc 5rc 6rc 7rc 80rc 82rc 84rc 85rc 153rc 157rc 158rc<br>160rc 165rc 168rc 203rc 204rc 205rc 253rc 441rc 444rc 516rc 521rc 524rc 582rc 583rc<br>584rc 633rc 1052rc 1392rc 1394rc 1417rc 1597rc 1609rc 1617rc 1620rc 1683rc 1744rc 1783r 1785rc<br>1788rc 1806r 1808r 1810rc 1811rc 1812rc 1813rc 1814rc 1815rc 1848rc 1886rc 1899rc 1900rc 2001rc<br>……太多不一一列出</p>
<p>说明:<br>这些进程号后面的rc是什么意思?</p>
<p>c 将此文件作为当前目录使用。<br>e 将此文件作为程序的可执行对象使用。<br>r 将此文件作为根目录使用。<br>s 将此文件作为共享库（或其他可装载对象）使用</p>
<p>2,如何列出进程的详细信息，而不仅仅是进程id?<br>用 -v参数即可<br>说明: -v: 含义是:verbose output,详细的输出信息<br>例子:</p>
<p>[root@dev ~]# fuser /var/log<br>/var/log: 4196c<br>[root@dev ~]# fuser -v /var/log</p>
<p>USER PID ACCESS COMMAND<br>/var/log: root 4196 ..c.. bash</p>
<p>3,如何列出进程所属的用户?<br>用 -u参数即可<br>说明: -u: 含义：display user IDs，显示用户id</p>
<p>例子:<br>[root@dev ~]# fuser -u /var/log<br>/var/log: 4196c(root)</p>
<p>4,如何杀死所有正在访问指定文件的进程?<br>用 -k参数即可<br>说明: -k：含义: kill processes accessing the named file</p>
<p>例子:</p>
<p>[root@localhost lhd]# fuser -v /root/install.log<br>用户 进程号 权限 命令<br>/root/install.log: root 3185 f…. tail<br>[root@localhost lhd]# fuser -k /root/install.log<br>/root/install.log: 3185<br>[root@localhost lhd]# fuser -v /root/install.log</p>
<p>说明: -k参数能够杀死所有的正在访问指定文件的进程，所以用来杀进程时非常方便<br>说明之二: fuser如何杀死的进程？<br>它发送的是这个信号:SIGKILL</p>
<p>三，多学一点知识</p>
<p>1,fuser可以列出它所知的信号:<br>用 -l参数即可</p>
<p>例子:<br>[root@dev ~]# fuser -l<br>HUP INT QUIT ILL TRAP ABRT IOT BUS FPE KILL USR1 SEGV USR2 PIPE ALRM TERM<br>STKFLT CHLD CONT STOP TSTP TTIN TTOU URG XCPU XFSZ VTALRM PROF WINCH IO PWR SYS<br>UNUSED</p>
<p>2,fuser可以发送它已知的信号给访问的指定文件进程而代替-k参数默认发送的SIGKILL<br>例如：只是挂起进程，那么发送HUP信号就可以了</p>
<p>例子:<br>[root@localhost lhd]# fuser -v /root/install.log<br>用户 进程号 权限 命令<br>/root/install.log: root 3347 f…. tail<br>[root@localhost lhd]# fuser -k -SIGHUP /root/install.log<br>/root/install.log: 3347<br>[root@localhost lhd]# fuser -v /root/install.log<br></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/03/19/服务器备份一例/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/03/19/服务器备份一例/" itemprop="url">
                  服务器备份一例
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-03-19T08:58:02+08:00">
                2009-03-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Server/" itemprop="url" rel="index">
                    <span itemprop="name">Server</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这两天服务器无故死机2次，查看log又没有看到有什么异常。只能怀疑是日常的备份让服务器给down掉了。然后今天就将日常备份脚本给删除了，希望这样能看出是不是备份的时候出的问题。<br><span> </span></p>
<p>顺便做个全备份。万一是硬件问题也不至于有太大问题。</p>
<ul>
<li>数据库备份时现成的（做了个小脚本，每3天都会自动备份一个），直接下载到本地机器上。</li>
<li>网站数据备份，因为看到log比较大，而我又不需要log资源，所以就去掉了log<br>语句如下：<br>nohup nice -n 19 tar –exclude var/www/web<em>/log/</em> -czvf /home/csbde/backup/webbak20090319.tar.gz /var/www/ &gt; /home/csbde/backup/webbak20090319.log</li>
</ul>
<p>语句简单解释：<br>退出终端以后还会继续执行（nohup),设置运行级为最低的19（nice -n 19），这样就不会因为运行这个程序而影响其他程序了。排除目录（–exclude var/www/web<em>/log/</em>）注意var前面没有/，好像有/也没关系，会自动帮你去掉。压缩/var/www/（我的网站目录）到webbak20090319.tar.gz，并写入log到webbak20090319.log</p>
<ul>
<li>备份/etc目录</li>
</ul>
<p>sudo nohup nice -n 19 tar cvzf bak_etc_20090320.tar.gz /etc &gt; bak_etc_20090320.log</p>
<ul>
<li>备份apache设置<br>sudo nohup nice -n 19 tar cvzf bak_apache_config_20090320.tar.gz /usr/local/apache2/conf &gt; bak_apache_config_20090320.log</li>
</ul>
<p><span>小知识点：</span></p>
<p><span> </span></p>
<blockquote>
<p><span style="font-size: x-small;">优先级范围-20~19,-20为最高优先级,19为最低<br>显示命令名，进程id即优先级</span></p>
<p>ps -eo cmd,pid,nice</p>
<p>按优先级N执行程序</p>
<p>nice -n N command</p>
<p>调整已执行程序的优先级</p>
<p>renice [+N/-N] process</p>
<p>或者使用top进行直观的调整（运行top然后按r）</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/02/16/vim里对程序的自动排版功能/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/02/16/vim里对程序的自动排版功能/" itemprop="url">
                  vim里对程序的自动排版功能
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-02-16T17:32:36+08:00">
                2009-02-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/02/13/ssh_超时(ssh_timeout)_解决办法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/02/13/ssh_超时(ssh_timeout)_解决办法/" itemprop="url">
                  ssh 超时(ssh timeout) 解决办法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-02-13T15:50:05+08:00">
                2009-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/SoftWare/" itemprop="url" rel="index">
                    <span itemprop="name">SoftWare</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原来的ssh是不会超时的, 但是不知道从什么时候起, 出现了ssh 超时现象:只要putty连续3分钟左右没有输入, 就自动断开, 然后必须重新登陆, 很麻烦.</p>
<p>在网上查了很多资料, 发现原因有多种, 环境变量TMOUT引起,ClientAliveCountMax和ClientAliveInterval设置问题或者甚至是防火墙的设置问题. 所以可以这么尝试:</p>
<p>1, echo $TMOUT<br>如果显示空白,表示没有设置, 等于使用默认值0, 一般情况下应该是不超时. 如果大于0, 可以在如/etc/profile之类文件中设置它为0.<br>Definition: TMOUT: If set to a value greater than zero, the value is interpreted as the number of seconds to wait for input after issuing the primary prompt. Bash terminates after waiting for that number of seconds if input does not arrive.<br>2. ClientAliveInterval 60<br>在/etc/ssh/sshd_config中增加ClientAliveInterval 60, ClientAliveInterval指定了服务器端向客户端请求消息的时间间隔, 默认是0, 不发送.而ClientAliveInterval 60表示每分钟发送一次, 然后客户端响应, 这样就保持长连接了.这里比较怪的地方是:不是客户端主动发起保持连接的请求(如FTerm, CTerm等),而是需要服务器先主动.</p>
<p>另外,至于ClientAliveCountMax, 使用默认值3即可.ClientAliveCountMax表示服务器发出请求后客户端没有响应的次数达到一定值, 就自动断开. 正常情况下, 客户端不会不响应.</p>
<p>ClientAliveCountMax<br>Sets the number of client alive messages (see below) which may be<br>sent without sshd(8) receiving any messages back from the client.<br>If this threshold is reached while client alive messages are<br>being sent, sshd will disconnect the client, terminating the ses-<br>sion. It is important to note that the use of client alive mes-<br>sages is very different from TCPKeepAlive (below). The client<br>alive messages are sent through the encrypted channel and there-<br>fore will not be spoofable. The TCP keepalive option enabled by<br>TCPKeepAlive is spoofable. The client alive mechanism is valu-<br>able when the client or server depend on knowing when a connec-<br>tion has become inactive.</p>
<p>The default value is 3. If ClientAliveInterval (see below) is<br>set to 15, and ClientAliveCountMax is left at the default, unre-<br>sponsive SSH clients will be disconnected after approximately 45<br>seconds. This option applies to protocol version 2 only.</p>
<p>ClientAliveInterval<br>Sets a timeout interval in seconds after which if no data has<br>been received from the client, sshd(8) will send a message<br>through the encrypted channel to request a response from the<br>client. The default is 0, indicating that these messages will<br>not be sent to the client. This option applies to protocol ver-<br>sion 2 only.</p>
<p>3. 启用putty keepalive<br>putty -&gt; Connection -&gt; Seconds between keepalives ( 0 to turn off ), 默认为0, 改为60.</p>
<p>4. 上述3个方法应该能解决大部分问题, 如果不行, 请 man sshd_config, 然后尝试更改其他设置吧.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/02/13/Linux文件名编码转换/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/02/13/Linux文件名编码转换/" itemprop="url">
                  Linux文件名编码转换
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-02-13T14:53:01+08:00">
                2009-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/SoftWare/" itemprop="url" rel="index">
                    <span itemprop="name">SoftWare</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>从Linux往windows 拷贝文件或者从windows往Linux拷贝文件，有时会出现中文文件名乱码的情况，出现这种问题的原因是因为，windows的文件名中文编码默认为 GBK,而Linux中默认文件名编码为UTF8,由于编码不一致，所以导致了文件名乱码的问题，解决这个问题需要对文件名进行转码。</p>
<p>在Linux中专门提供了一种工具convmv进行文件名编码的转换，可以将文件名从GBK转换成UTF-8编码,或者从UTF-8转换到GBK。</p>
<p>首先看一下你的系统上是否安装了convmv,如果没安装的话用:<br>yum -y install convmv<br>安装。<br>下面看一下convmv的具体用法：</p>
<p>convmv -f 源编码 -t 新编码 [选项] 文件名</p>
<p>常用参数：<br>-r 递归处理子文件夹<br>–notest 真正进行操作，请注意在默认情况下是不对文件进行真实操作的，而只是试验。<br>–list 显示所有支持的编码<br>–unescap 可以做一下转义，比如把%20变成空格<br>比如我们有一个utf8编码的文件名，转换成GBK编码，命令如下：</p>
<p>convmv -f UTF-8 -t GBK –notest utf8编码的文件名</p>
<p>这样转换以后”utf8编码的文件名”会被转换成GBK编码（只是文件名编码的转换，文件内容不会发生变化）。</p>
<p>注意：不要在NTFS和FAT文件系统中使用此命令，否则可能产生意外结果，如果要在Linux中正确的显示NTFS和 FAT的中文件名，可以通过mount参数来解决，具体方法查看一下man手册。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/01/25/'50元以内的共享上网方法(单网卡,ADSL+HUB集线器)'/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/01/25/'50元以内的共享上网方法(单网卡,ADSL+HUB集线器)'/" itemprop="url">
                  50元以内的共享上网方法(单网卡,ADSL+HUB集线器)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-01-25T15:41:51+08:00">
                2009-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Other/" itemprop="url" rel="index">
                    <span itemprop="name">Other</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>网络共享是网络应用的很重要的方面,特别是现在很多家庭里都2台以上的电脑.总不能再拉根网线吧,我们还是工薪阶级。举一个简单例子，家里装了ADSL宽带，但是家里有几台电脑，在只有一个Ip地址条件下怎么实现上网。一个简单实用的方案就是单网卡共享ADSL方案。从字面上理解很多人以为单网卡共享ADSL方案就是只有一个网卡，其实是连接的每台电脑都需要网卡，我们所说的单网卡是指服务器的那台机器只有一个网卡。网上有很多文章都介绍这种方案，但是按照这些文章所说的方面很多难实现共享上网，而且很多具体的步骤说的不清楚。我今天详细介绍单网卡共享组网,只需要一个HUB集线器就搞定,连ADSL都不要有路由功能,像我家的ADSL拨号的就是电信送的,没有路由管理功能。<br>一、组网方案原理<br>二、硬件连接（只需一张网卡）<br>网卡：服务器与客户机均使用一张带有RJ45接口的10M或100M网卡。<br>集线器(HUB)：只需要一个集线器<br>网线: 需要准备两种，一种是ADSL MODEM与集线器连接的交叉线一条；第二种是每台机器与集线器的直连线，有多少台机器就买多少条，长度按照每台机器的具体距离来买。当然网线需要带水晶头。<br>三、操作过程<br>按照上面的图连接好各个硬件。连线应该不存在任何的困难，有一点要注意的，交叉线和直连线不要连错了。<br>服务器设置：<br>由于采用了其中一台机做服务器，所以我们先要对这台机器进行设置。<br>1、在网上邻居&#8212;&gt;属性页面，可以见到两个连接，一个是本地连接，另一个是ADSL连接。如图所示：<br>2、保证本机ADSL能拨号成功的前提下，打开ADSL连接的属性页，在&#8220;高级&#8221;页中选中&#8220;允许其他网络用户通过此计算机的internet连接来连接&#8221;和&#8220;在我的网络上的计算机尝试访问internet时建立一个拨号连接&#8221;<br>3、打开本地连接&#8212;&gt;属性。设置如下：192.168.0.1<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 255.255.255.0<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 192.168.0.1<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DNS:&#160;&#160;&#160; 202.96.128.86(68)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 202.96.128.110<br>4、此时计算机会提示，如果启用此连接的internet连接共享，会自动将本地连接的IP地址置为：192.168.0.1，与internet的连接可能会失效。不用管它的警告，点&#8220;是&#8221;就行。<br>5、如果计算机提示这个IP地址与网上的其他IP地址冲突，不要紧，是因为其他的局域网服务器用了这个（192.168.0.1）作网关。我们拨掉网线，再按确定好了。<br>6、然后，重新启动机器，将网卡的IP地地重新设置为ISP指定的IP地址即可。此时，在我们建立的ADSL拨号连接上出现了一个共享的标记：一只手托着这个连接，说明共享已经打开。然后，一切OK。<br>客户机设置：<br>打开本地连接&#8212;&gt;属性。设置如下：A:192.168.0.2&#160;&#160;&#160; B:192.168.0.3<br>设置好后，在DOS 窗口下用 Ping 192.168.0.1 或 2、3分别测试各机器中间的通讯是否正常。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2009/01/23/将阅读权限限制修改为威望（积分）限制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="九王爷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="九王爷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2009/01/23/将阅读权限限制修改为威望（积分）限制/" itemprop="url">
                  将阅读权限限制修改为威望（积分）限制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2009-01-23T18:02:38+08:00">
                2009-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SoftWare/" itemprop="url" rel="index">
                    <span itemprop="name">SoftWare</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre lang="php">将阅读权限限制修改为威望（积分）限制

1、修改数据库(可以不修改)

登录数据库，表 x__threads （x表示表前缀）中 readperm 字段 结构修改

A．将 类型  tinyint  修改为 smallint
B．将 长度 3 修改为6
C．属性  UNSIGNED （不修改）
D．NULL 选择 not null （不修改）
E. 默认值选择 0 （不修改）

2\. 打开 include/common.inc.php

到第 157 行
if($thread['readperm'] && $thread['readperm'] > $readaccess && !$forum['ismoderator'] && $thread['authorid'] != $discuz_uid) {
    showmessage('thread_nopermission', NULL, 'NOPERM');
}
修改为
if($thread['readperm'] && $thread['readperm'] > $extcredits1  && !$forum['ismoderator'] && $thread['authorid'] != $discuz_uid) {
    showmessage('thread_nopermission', NULL, 'NOPERM');
}
//其中$extcredits1 可以更改为$extcredits 积分; 如extcredits1 积分1(威望); extcredits2 积分2(金钱); extcredits3; extcredits4;extcredits5 ;extcredits6 ;extcredits7; extcredits8,可以自行选择一个，或者自行设置加减。
3\. 修改模板文件，将 “阅读权限”替换为 “威望”或“积分”

3.1 找到 templates\default\templates.lang.php （一共有3行，修改前两行）

第 416 行
'readperm' =&gt; '阅读权限',
修改为
'readperm' =&gt; '威望',

417行
'readperm_thread' =&gt; '所需阅读权限',
修改为
'readperm_thread' =&gt; '所需威望',

3.2 找到templates\default\messages.lang.php （一共有2行，全部替换）

第 47 行
'thread_nopermission' =&gt; '对不起，本帖要求阅读权限高于 $thread[readperm] 才可浏览，请返回。',
修改为
'thread_nopermission' =&gt; '对不起，本帖要求威望高于 $thread[readperm] 才可浏览，请返回。',

第90行
'attachment_nopermission' =&gt; '对不起，本附件要求阅读权限高于 $attach[readperm] 才可下载，请返回。',
修改为
'attachment_nopermission' =&gt; '对不起，本附件要求威望高于 $attach[readperm] 才可下载，请返回。',

3.3找到templates\default\messages.lang.php
第51行
'attach_readperm' =&gt; '阅读权限',
修改为
'attach_readperm' =&gt; '威望',

3.3找到\forumdata\cache\目录下 （可替换，也可不替换）
cache_viewpro.php 和 cache_viewthread.php

将 阅读权限 替换为 威望</pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/27/">27</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="九王爷" />
          <p class="site-author-name" itemprop="name">九王爷</p>
           
              <p class="site-description motion-element" itemprop="description">这里是外宅，备份用的</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">268</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">41</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">九王爷</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


  

</body>
</html>
